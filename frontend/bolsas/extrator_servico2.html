<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assistente de Despachos - Serviços</title>
    <style>
        body { font-family: sans-serif; background-color: #f4f4f4; display: flex; justify-content: center; align-items: flex-start; padding: 20px; gap: 30px; flex-wrap: wrap; }
        .container { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); width: 480px; }
        h2 { text-align: center; color: #333; margin-top: 0; }
        textarea { width: 95%; height: 180px; margin-bottom: 10px; padding: 10px; border: 1px solid #ccc; border-radius: 4px; resize: vertical; }
        .form-grid { display: grid; grid-template-columns: 1fr 2fr 1fr; gap: 10px; align-items: center; }
        .form-grid label { font-weight: bold; text-align: right; padding-right: 10px; color: #555; font-size: 14px; }
        .form-grid input, .form-grid select { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        .btn { padding: 8px 12px; border: none; border-radius: 4px; cursor: pointer; background-color: #555; color: white; width: 100%; font-size: 13px; }
        .btn:hover { background-color: #333; }
        .btn-process { background-color: #28a745; color: white; font-size: 16px; padding: 12px; width: 100%; }
        .btn-process:hover { background-color: #218838; }
        .generator-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px; }
        .generator-grid .btn-gen { padding: 15px 10px; font-size: 14px; text-align: center; }
        #output-container { margin-top: 20px; }
        #output-container h3 { text-align: center; color: #333; }
        #despachoGerado { height: 100px; }
        
        /* ESTILO PARA OS NOVOS CAMPOS */
        .natureza-despesa-container {
            grid-column: 2 / span 2; /* Faz o container ocupar 2 colunas do grid */
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 5px;
        }
        #cta_pcasp {
            background-color: #e9ecef; /* Cor de fundo para indicar que é um campo automático */
        }
    </style>
</head>
<body>

    <div class="container">
        <h2>1. Cole os Dados do Serviço</h2>
        <textarea id="inputText" placeholder="Cole o bloco de informações do serviço aqui..."></textarea>
        <button onclick="processarTextoServicos()" class="btn-process">Extrair Dados para Formulário</button>
    </div>

    <div class="container">
        <h2>2. Edite e Copie os Dados</h2>
        <div class="form-grid">
            <label for="processo">Processo</label>
            <input type="text" id="processo"> <button class="btn" onclick="copiar('processo')">Copiar</button>
            <label for="ateste">Ateste</label>
            <input type="text" id="ateste"> <button class="btn" onclick="copiar('ateste')">Copiar</button>
            <label for="valor">Valor</label>
            <input type="text" id="valor"> <button class="btn" onclick="copiar('valor')">Copiar</button>
            <label for="cnpj">CNPJ CREDOR</label>
            <input type="text" id="cnpj"> <button class="btn" onclick="copiar('cnpj')">Copiar</button>
            <label for="data_emissao">Data de Emissão</label>
            <input type="text" id="data_emissao"> <button class="btn" onclick="copiar('data_emissao')">Copiar</button>
            <label for="nf">NF</label>
            <input type="text" id="nf"> <button class="btn" onclick="copiar('nf')">Copiar</button>
            <label for="ref">REF.</label>
            <input type="text" id="ref"> <button class="btn" onclick="copiar('ref')">Copiar</button>
            <label for="ref_servico">REF. SERVIÇO</label>
            <input type="text" id="ref_servico" placeholder="Preencher manualmente..."> <button class="btn" onclick="copiar('ref_servico')">Copiar</button>
            <label for="fonte">FONTE</label>
            <input type="text" id="fonte" placeholder="Preencher manualmente..."> <button class="btn" onclick="copiar('fonte')">Copiar</button>
            <label for="contrato">CONTRATO</label>
            <input type="text" id="contrato"> <button class="btn" onclick="copiar('contrato')">Copiar</button>
            <label for="conta_vinculada">Conta Vinculada</label>
            <input type="text" id="conta_vinculada"> <button class="btn" onclick="copiar('conta_vinculada')">Copiar</button>
            <label for="empenho">EMPENHO</label>
            <input type="text" id="empenho"> <button class="btn" onclick="copiar('empenho')">Copiar</button>
            
            <!-- CAMPOS DE NATUREZA DA DESPESA ADICIONADOS -->
            <label>NATUREZA DA DESPESA</label>
            <div class="natureza-despesa-container">
                <input type="text" id="cta_origem" placeholder="CTA Origem" onkeyup="atualizarCtaPcasp()">
                <input type="text" id="cta_pcasp" placeholder="CTA PCASP" readonly>
            </div>
            <button class="btn" onclick="copiar('cta_pcasp')">Copiar PCASP</button>
            
            <label for="simples_nacional">Optante do Simples Nacional?</label>
            <select id="simples_nacional">
                <option value="Não">Não</option>
                <option value="Sim">Sim</option>
            </select>
            <div></div> 
        </div>
    </div>

    <div class="container">
        <h2>3. Gere um Novo Despacho</h2>
        <div class="generator-grid">
            <button class="btn btn-gen" onclick="gerarDespachoServicos('LIQUIDAÇÃO')">Liquidação</button>
            <button class="btn btn-gen" onclick="gerarDespachoServicos('PAGAMENTO')">Pagamento</button>
            <button class="btn btn-gen" onclick="gerarDespachoServicos('TRIB. FED.')">TRIB. FED.</button>
            <button class="btn btn-gen" onclick="gerarDespachoServicos('ISS')">ISS</button>
            <button class="btn btn-gen" onclick="gerarDespachoServicos('INSS')">INSS</button>
            <button class="btn btn-gen" onclick="gerarDespachoServicos('CONTA VINCULADA')">Conta Vinculada</button>
        </div>
        <hr>
        <div id="output-container">
            <h3>Despacho Gerado:</h3>
            <textarea id="despachoGerado" placeholder="O texto do novo despacho aparecerá aqui..."></textarea>
            <button class="btn" onclick="copiar('despachoGerado')">Copiar Despacho Gerado</button>
        </div>
    </div>

<script>
    // ##################################################################
    // IMPORTANTE: COLE SUA LISTA DE CÓDIGOS AQUI DENTRO
    // Mantenha o formato: 'CTA_ORIGEM': 'CTA_PCASP',
    // ##################################################################
    const mapeamentoCta = {
    '33903701': '332310200',
    '33903702': '332310200',
    '33903703': '332310200',
    '33903704': '332310200',
    '33903705': '332310200',
    '33903706': '332310200',
    '33903707': '332310200',
    '33903708': '332310200',
    '33903709': '332310200',
    '33903727': '332310200',
    '33903728': '332310200',
    '33903735': '342310200',
    '33903736': '342310300',
    '33903737': '342310100',
    '33903799': '332310200',
    '33903801': '332310900',
    '33903802': '332310900',
    '33903803': '332310900',
    '33903804': '332310900',
    '33903805': '332310900',
    '33903899': '332310900',
    '33903901': '332310300',
    '33903902': '332310500',
    '33903903': '332310500',
    '33903904': '332319900',
    '33903905': '332310100',
    '33903906': '332310200',
    '33903907': '344010100',
    '33903908': '332310100',
    '33903909': '332310200',
    '33903910': '332310900',
    '33903911': '332310900',
    '33903912': '332310900',
    '33903913': '332310100',
    '33903914': '332310900',
    '33903915': '332310900',
    '33903916': '332310200',
    '33903917': '332310200',
    '33903918': '332310200',
    '33903919': '332310200',
    '33903920': '332310200',
    '33903921': '332310200',
    '33903922': '332311000',
    '33903923': '332311000',
    '33903924': '332310100',
    '33903925': '332310500',
    '33903926': '332310100',
    '33903927': '332310100',
    '33903928': '332310100',
    '33903929': '332310100',
    '33903930': '332310100',
    '33903931': '332310900',
    '33903934': '343910200',
    '33903935': '342310200',
    '33903936': '342310300',
    '33903937': '342310100',
    '33903938': '343910101',
    '33903939': '343910102',
    '33903940': '332311200',
    '33903941': '332311200',
    '33903942': '332319900',
    '33903943': '332310800',
    '33903944': '332310800',
    '33903945': '332310800',
    '33903946': '332310200',
    '33903947': '332310300',
    '33903948': '332310100',
    '33903949': '332310300',
    '33903950': '332310100',
    '33903951': '332310100',
    '33903952': '332310600',
    '33903953': '332310600',
    '33903954': '332310600',
    '33903955': '332310700',
    '33903956': '332310100',
    '33903957': '332310100',
    '33903958': '332310300',
    '33903959': '332310300',
    '33903960': '332310200',
    '33903961': '332310200',
    '33903962': '332310100',
    '33903963': '332310300',
    '33903964': '332310100',
    '33903965': '332311000',
    '33903966': '332310100',
    '33903967': '332310600',
    '33903968': '332310200',
    '33903969': '332311300',
    '33903970': '332310700',
    '33903971': '332310700',
    '33903972': '332340400',
    '33903973': '332310400',
    '33903974': '332310400',
    '33903975': '332310200',
    '33903976': '332310100',
    '33903977': '332310200',
    '33903978': '332310200',
    '33903979': '332310200',
    '33903980': '332310400',
    '33903981': '332310500',
    '33903982': '332310100',
    '33903983': '332310200',
    '33903985': '332310200',
    '33903986': '332311000',
    '33903987': '332310200',
    '33903988': '332311000',
    '33903989': '332310200',
    '33903990': '332310300',
    '33903991': '332310300',
    '33903992': '332310300',
    '33903993': '332310300',
    '33903995': '332310200',
    '33903997': '332310300',
    '33903999': '332319900',
    '33904501': '395010100',
    '33904502': '395010100',
    '33904503': '395010100',
    '33904504': '395010100',
    '33904507': '395010100',
    '33904508': '395010100',
    '33904509': '395010100',
    '33904510': '395010100',
    '33904511': '395010100',
    '33904512': '395010100',
    '33904513': '395010100',
    '33904514': '395010100',
    '33904516': '395010100',
    '33904517': '395010100',
    '33904519': '395010100',
    '33904520': '395010100',
    '33904521': '395010100',
    '33904522': '395010100',
    '33904523': '395010100',
    '33904599': '395010100',
    '33904601': '313110100',
    '33904701': '371110100',
    '33904702': '371110200',
    '33904703': '371110300',
    '33904704': '371110400',
    '33904705': '371110500',
    '33904706': '371110600',
    '33904707': '371110700',
    '33904708': '371110800',
    '33904709': '371110900',
    '33904710': '371210100',
    '33904711': '372110100',
    '33904712': '372110200',
    '33904713': '372110300',
    '33904715': '342410200',
    '33904716': '342410100',
    '33904717': '372910100',
    '33904718': '372110400',
    '33904720': '372110500',
    '33904721': '372110600',
    '33904722': '372310100',
    '33904723': '372910100',
    '33904724': '371310100',
    '33904725': '371111000',
    '33904727': '342410300',
    '33904728': '371111100',
    '33904791': '343910200',
    '33904801': '319910100',
    '33904802': '319910100',
    '33904803': '319910200',
    '33904804': '319910300',
    '33904806': '394110100',
    '33904807': '394110100',
    '33904808': '394310100',
    '33904901': '313110200',
    '33904903': '332210900',
    '33905301': '321210200',
    '33905302': '321210200',
    '33905303': '321210200',
    '33905304': '321210200',
    '33905305': '321210200',
    '33905306': '321210400',
    '33905401': '321210100',
    '33905402': '321210100',
    '33905403': '321210100',
    '33905404': '321210100',
    '33905405': '321210100',
    '33905406': '321210300',
    '33905501': '322210200',
    '33905502': '322210200',
    '33905503': '322210200',
    '33905504': '322210400',
    '33905505': '322210400',
    '33905601': '322210100',
    '33905602': '322210100',
    '33905603': '322210100',
    '33905604': '322210300',
    '33905605': '322210300',
    '33905701': '329210102',
    '33905702': '329210102',
    '33905703': '329210102',
    '33905704': '329210102',
    '33905705': '329210102',
    '33905706': '329210102',
    '33905707': '329210104',
    '33905801': '329210101',
    '33905802': '329210101',
    '33905803': '329210101',
    '33905804': '329210101',
    '33905805': '329210101',
    '33905806': '329210101',
    '33905807': '329210103',
    '33905808': '329210101',
    '33905809': '329210101',
    '33905810': '329210101',
    '33905811': '329210101',
    '33905812': '329210101',
    '33905901': '322910200',
    '33905902': '322910200',
    '33905903': '322910200',
    '33905904': '322910200',
    '33905905': '322910200',
    '33905906': '322910200',
    '33905907': '322910200',
    '33905908': '322910200',
    '33905999': '322910200',
    '33909103': '332211000',
    '33909190': '313110900',
    '33913906': '332320200',
    '33913907': '344020100',
    '33913908': '332320200',
    '33913909': '332320200',
    '33913910': '332320900',
    '33913911': '332320900',
    '33913912': '332320900',
    '33913913': '332320100',
    '33913914': '332320900',
    '33913915': '332320900',
    '33913916': '332320200',
    '33913917': '332320200',
    '33913919': '332320200',
    '33913920': '332320200',
    '33913921': '332320200',
    '33913922': '332321000',
    '33913923': '332321000',
    '33913925': '332320500',
    '33913926': '332320100',
    '33913927': '332320100',
    '33913928': '332320100',
    '33913929': '332320100',
    '33913930': '332320100',
    '33913931': '332320900',
    '33913934': '343920200',
    '33913938': '343920101',
    '33913939': '343920102',
    '33913940': '332321100',
    '33913941': '332321100',
    '33913942': '332321100',
    '33913943': '332320800',
    '33913944': '332320800',
    '33913945': '332320800',
    '33913946': '332320200',
    '33913947': '332320300',
    '33913948': '332320100',
    '33913949': '332320300',
    '33913950': '332320100',
    '33913951': '332321000',
    '33913952': '332320600',
    '33913953': '332320600',
    '33913954': '332320600',
    '33913955': '332320700',
    '33913957': '332320100',
    '33913958': '332320300',
    '33913959': '332320300',
    '33913960': '332320200',
    '33913961': '332320200',
    '33913962': '332320100',
    '33913963': '332320300',
    '33913965': '332321000',
    '33913966': '332320100',
    '33913968': '332320200',
    '33913970': '332320700',
    '33913971': '332320700',
    '33913974': '332320400',
    '33913975': '332320200',
    '33913976': '332320100',
    '33913977': '332320200',
    '33913978': '332320200',
    '33913979': '332320200',
    '33913980': '332320400',
    '33913981': '332320500',
    '33913982': '332320100',
    '33913983': '332320200',
    '33913985': '332320200',
    '33913986': '332321000',
    '33913987': '332320200',
    '33913989': '332320200',
    '33913990': '332320300',
    '33913991': '332320300',
    '33913992': '332320300',
    '33913993': '332320300',
    '33913995': '332320200',
    '33913997': '332320300',
    '33914701': '371120100',
    '33914703': '371120300',
    '33914704': '371120400',
    '33914706': '371120600',
    '33914709': '371120900',
    '33914710': '371220100',
    '33914711': '372120100',
    '33914712': '372120200',
    '33914713': '372120300',
    '33914715': '342420200',
    '33914716': '342420100',
    '33914718': '372120400',
    '33914720': '372120500',
    '33914723': '372920100',
    '33914724': '371320100',
    '33914725': '371121000',
    '33914727': '342420300',
    '33914728': '372920100',
    '33914791': '343920200',
    '33919601': '319220100',
    '33919801': '351420102',
    '42120400': '123110101',
    '42120600': '123110102',
    '42120800': '123110103',
    '42121000': '123110104',
    '42121200': '123110301',
    '42121300': '123119904',
    '42121400': '123110900',
    '42121800': '123110402',
    '42121900': '123110403',
    '42122000': '123110506',
    '42122200': '123110118',
    '42122400': '123110105',
    '42122600': '123110404',
    '42122800': '123110106',
    '42123000': '123110107',
    '42123200': '123110108',
    '42123300': '123110405',
    '42123400': '123110125',
    '42123500': '123110201',
    '42123600': '123110302',
    '42123800': '123110109',
    '42123900': '123110121',
    '42124000': '123110120',
    '42124200': '123110303',
    '42124400': '123110406',
    '42124600': '123110110',
    '42124800': '123110501',
    '42124900': '123110111',
    '42125000': '123110502',
    '42125100': '123119909',
    '42125200': '123110503',
    '42125300': '123110504',
    '42125400': '123110114',
    '42125500': '123110201',
    '42125600': '123110115',
    '42125700': '123110112',
    '42125800': '123110116',
    '42126000': '123110113',
    '42128200': '123110122',
    '42128300': '123110119',
    '42128400': '123119903',
    '42128500': '123119998',
    '42128600': '123119906',
    '42128700': '123119910',
    '42128800': '123119998',
    '42128900': '123110117',
    '42129000': '123119907',
    '42129100': '123119901',
    '42129201': '123110801',
    '42129202': '123110802',
    '42129203': '123110803',
    '42129204': '123110804',
    '42129205': '123110805',
    '42129300': '123119902',
    '42129400': '123119905',
    '42129500': '123110702',
    '42129600': '123110703',
    '42129700': '123110701',
    '42129800': '123119908',
    '42129900': '123119999',
    '42220000': '121310199',
    '42310000': '124210100',
    '42320000': '124210400',
    '42330000': '124110000',
    '42360000': '124210200',
    '42370000': '123219998',
    '42390000': '124219900',
    '42700000': '123810200',
    '42800000': '123910100',
    '42900000': '123810100',
    '43100000': '125110100',
    '43300000': '125110200',
    '43700000': '125110300',
    '43900000': '125910100',
    '44100000': '124110000',
    '44200000': '124210100',
    '44300000': '124310000',
    '44400000': '124210200',
    '44500000': '124210300',
    '44600000': '124110000',
    '44700000': '124210500',
    '44717001': '355010100',
    '44800000': '124910100',
    '44900000': '124810100',
    '11110101': '411110100',
    '11110102': '411110100',
    '11110201': '411110200',
    '11110202': '411110200',
    '11120101': '411210101',
    '11120102': '411210102',
    '11120410': '411210201',
    '11120411': '411210202',
    '11120421': '411210202',
    '11120422': '411210202',
    '11120423': '411210202',
    '11120431': '411210201',
    '11120432': '411210202',
    '11120433': '411210202',
    '11120434': '411220299',
    '11120435': '411210202',
    '91110000': '621100000',
    '91140000': '621200000',
    '92110101': '522110101',
    '92110102': '522110102',
    '92110201': '522110201',
    '92110202': '522110202',
    '92110209': '522110209',
    '92110301': '522120101',
    '92110302': '522120102',
    '92110303': '522120103',
    '92130101': '522120201',
    '92130102': '522120203',
    '92410190': '522920105',
    '92410430': '522920303',
    '92410532': '622820000',
    '92410601': '522920101',
    '92410602': '522920102',
    '92410609': '522920104',
    '92440200': '622910300',
    '92460100': '799110000',
    '92460200': '799110000',
    '92460301': '799110000',

    '33901801': '394110100',
    '33901802': '394110200',
    '33901803': '325010100',
    '33901804': '394110300',
    '33901805': '325010100',
    '33901899': '394119900',
    '33901901': '313310700',
    '33902001': '394210100',
    '33902002': '394210200',
    '33902701': '399910200',
    '33903001': '331110300',
    '33903002': '331110300',
    '33903003': '331110300',
    '33903004': '331110100',
    '33903005': '331110100',
    '33903006': '331110100',
    '33903007': '331110400',
    '33903008': '331110100',
    '33903009': '331110600',
    '33903010': '331110100',
    '33903011': '331110100',
    '33903012': '331110100',
    '33903013': '331110100',
    '33903014': '331110100',
    '33903015': '331110100',
    '33903016': '331110100',
    '33903017': '331110500',
    '33903018': '331110100',
    '33903019': '331110100',
    '33903020': '331110100',
    '33903021': '331110100',
    '33903022': '331110100',
    '33903023': '331110100',
    '33903024': '331110100',
    '33903025': '331110100',
    '33903026': '331110100',
    '33903027': '331110100',
    '33903028': '331110100',
    '33903029': '331110100',
    '33903030': '331110100',
    '33903031': '331110100',
    '33903032': '331110100',
    '33903033': '331110800',
    '33903034': '331110100',
    '33903035': '331110100',
    '33903036': '331110700',
    '33903037': '331110100',
    '33903038': '331110100',
    '33903039': '331110100',
    '33903040': '331110100',
    '33903041': '331110100',
    '33903042': '331110100',
    '33903043': '331110100',
    '33903044': '331110100',
    '33903045': '331110100',
    '33903046': '331110100',
    '33903048': '331110100',
    '33903049': '331110100',
    '33903050': '331110100',
    '33903051': '331110100',
    '33903052': '331110100',
    '33903053': '331110100',
    '33903054': '331110100',
    '33903055': '331110100',
    '33903057': '331110100',
    '33903058': '331110100',
    '33903059': '331110100',
    '33903089': '331110100',
    '33903091': '343910200',
    '33903099': '331119900',
    '33903101': '391110100',
    '33903102': '391210100',
    '33903103': '391310100',
    '33903104': '391410100',
    '33903105': '391510100',
    '33903106': '391910100',
    '33903107': '391910100',
    '33903199': '391910100',
    '33903203': '331210100',
    '33903204': '331210100',
    '33903205': '331210100',
    '33903206': '331210100',
    '33903207': '331210100',
    '33903208': '331210100',
    '33903209': '331210100',
    '33903210': '331210100',
    '33903211': '331210100',
    '33903212': '331210100',
    '33903213': '331210100',
    '33903214': '331210100',
    '33903215': '331210100',
    '33903216': '331210100',
    '33903290': '331210100',
    '33903291': '343910200',
    '33903299': '331210100',
    '33903301': '332310400',
    '33903302': '332310400',
    '33903303': '332210400',
    '33903304': '332210400',
    '33903305': '332210400',
    '33903306': '332210400',
    '33903307': '332310400',
    '33903308': '332310400',
    '33903309': '332310400',
    '33903310': '332210400',
    '33903311': '332310400',
    '33903391': '343910200',
    '33903399': '332210400',
    '33903401': '332410100',
    '33903501': '332210100',
    '33903502': '332210100',
    '33903504': '332210100',
    '33903612': '332210200',
    '33903613': '332210900',
    '33903614': '332210200',
    '33903615': '332210800',
    '33903616': '332210800',
    '33903617': '332210800',
    '33903618': '332210200',
    '33903619': '332210200',
    '33903620': '332210200',
    '33903621': '332210200',
    '33903622': '332210200',
    '33903623': '332219900',
    '33903624': '332219900',
    '33903625': '332210200',
    '33903626': '332210200',
    '33903627': '332210300',
    '33903628': '332210100',
    '33903629': '332210100',
    '33903630': '332210100',
    '33903631': '332210600',
    '33903632': '332210600',
    '33903634': '332210100',
    '33903635': '332210200',
    '33903636': '332210200',
    '33903637': '332210700',
    '33903638': '332210700',
    '33903639': '332210400',
    '33903640': '343910101',
    '33903641': '342310200',
    '33903642': '342310100',
    '33903643': '343910102',
    '33903645': '332210100',
    '33903646': '332110100',
    '33903654': '332210200',
    '33903656': '343910200',
    '33903659': '332210300',
    '33903663': '332210300',
    '33903666': '332210100',
    '33903669': '332219900',
    '33903680': '332210400',
    '33903689': '332210200',
    '33903699': '332219900',
    '33903701': '332310200'
};
    // ##################################################################

    // NOVA FUNÇÃO PARA ATUALIZAR O CAMPO PCASP
    function atualizarCtaPcasp() {
        const ctaOrigemInput = document.getElementById('cta_origem');
        const ctaPcaspInput = document.getElementById('cta_pcasp');
        const origemValue = ctaOrigemInput.value;

        // Procura o valor no objeto de mapeamento
        const pcaspValue = mapeamentoCta[origemValue];

        if (pcaspValue) {
            ctaPcaspInput.value = pcaspValue; // Se encontrar, preenche o campo
        } else {
            ctaPcaspInput.value = ''; // Se não encontrar, limpa o campo
        }
    }

    function processarTextoServicos() {
        // ... (o resto do código permanece igual)
        const texto = document.getElementById('inputText').value;
        document.querySelectorAll('.form-grid input').forEach(input => input.value = '');
        const regex = {
            cnpj: /(\d{2}\.\d{3}\.\d{3}\/\d{4}-\d{2})/,
            processo: /Proc\.\(s\) núm\.\(s\):\s*([\d\.\/\-]+)/,
            nf: /Instr\.\(s\) de Cobrança\(s\) núm\.\(s\):\s*([\d\.]+)/,
            contrato: /Contrato nº:\s*([\d\/]+)/,
            ref: /mês\(es\):\s*([\d\/]+)/,
            valor: /R\$\s*([\d\.,]+)/,
            empenho: /(\d{4}NE\d+)/,
            data_emissao: /(\d{2}\/\d{2}\/\d{4})/ 
        };
        for (const chave in regex) {
            const match = texto.match(regex[chave]);
            if (match) {
                document.getElementById(chave).value = match[1].trim();
            }
        }
    }

    function copiar(elementId) {
        const input = document.getElementById(elementId);
        let textoParaCopiar = input.value; 
        if (!textoParaCopiar) return; 
        navigator.clipboard.writeText(textoParaCopiar).catch(err => {
            console.error('Erro ao copiar texto: ', err);
        });
    }

    function gerarDespachoServicos(tipo) {
        const dados = {
            processo: document.getElementById('processo').value || '[PROCESSO PENDENTE]',
            nf: document.getElementById('nf').value || '[NF PENDENTE]',
            data_emissao: document.getElementById('data_emissao').value || '[DATA PENDENTE]',
            valor: document.getElementById('valor').value || '[VALOR PENDENTE]',
            ref: document.getElementById('ref').value || '[REF. PENDENTE]',
            ref_servico: document.getElementById('ref_servico').value || '[REF. SERVIÇO PENDENTE]',
            contrato: document.getElementById('contrato').value || '[CONTRATO PENDENTE]',
            fonte: document.getElementById('fonte').value || '[FONTE PENDENTE]'
        };
        const isSimples = document.getElementById('simples_nacional').value;
        let despachoGerado = `${tipo} DA NF ${dados.nf} DE ${dados.data_emissao} - VALOR R$ ${dados.valor} - REF. ${dados.ref} - REF. SERVIÇO ${dados.ref_servico} - CONTRATO ${dados.contrato} - PROCESSO: ${dados.processo} - FONTE: ${dados.fonte}`;
        if (isSimples === 'Sim') {
            despachoGerado += ' - Optante do Simples Nacional';
        }
        document.getElementById('despachoGerado').value = despachoGerado;
    }
</script>

</body>
</html>